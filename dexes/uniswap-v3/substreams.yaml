specVersion: v0.1.0

package:
  name: coinranking_uniswap_v3
  version: v0.2.0
  url: https://github.com/coinranking/substreams
  description: "Real-time block-aggregated swap data for Uniswap V3 pools on Ethereum mainnet"

imports:
  uniswap: https://github.com/streamingfast/substreams-uniswap-v3/releases/download/v0.2.10/substreams-uniswap-v3-v0.2.10.spkg

protobuf:
  files:
    - dex_common.proto
  importPaths:
    - ../../proto                # adjust if needed

binaries:
  default:
    type: wasm/rust-v1
    file: ../../target/wasm32-unknown-unknown/release/coinranking_uniswap_v3.wasm

network: mainnet

# ─────────────────────────── modules ────────────────────────────
modules:
  # Block-aggregated ticker output (no stores!)
  - name: map_uniswap_ticker_output
    kind: map
    initialBlock: 22988219
    inputs:
      - source: sf.ethereum.type.v2.Block
      - map: uniswap:uni_v0_2_9:map_pools_created
      - map: uniswap:uni_v0_2_9:map_extract_data_types
    output:
      type: proto:dex.common.v1.DexOutput
